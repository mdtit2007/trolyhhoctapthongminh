
@{
    ViewBag.Title = "Index";
}
<div class="container"id="divlogin">
    <input type="text"id="txtName" placeholder="Nhập họ và tên..."/>
    <button class="btn btn-success"id="btnLogin">Login</button>
    <input type="hidden"id="hName"/>
</div>
<div class="container   "id="divChat" >
    <h2 id="welcome"></h2>
    <input type="text"id="txtMessage"/>
    <button class="btn btn-success" id="btnSend">Gửi</button>
</div>
<div class="container">
    <ul id="contentMsg">

    </ul>
    </div>
@section scripts{
    <script>
        function show() {
            $('#divlogin').hide();
            $('#divChat').show();
        }
        function hide() {
            $('#divChat').hide();
            $('#divlogin').show();
        }
        $(function () {
            $('#divChat').hide();
            var chat = $.connection.chat;
            console.log(chat);
            loadClient(chat);
            $.connection.hub.start().done(function () {
                $('#btnLogin').click(function () {
                    var name = $('#txtName').val();
                    chat.server.connect(name);
                    $.('#welcome').html("Xin chào:" + name);
                    show();
                });
                $('#btnSend').click(function () {
                    var msg = $('#txtMessage').val();
                    
                    chat.server.message(msg);
                    $('#txtMessage').val('').focus();
                });
            })
        });

        function loadClient(chat) {
            chat.client.message = function (msg) { 
                $('#contentMsg').append("<li>" + msg + "</li>");
            }
            chat.client.connect = function (name) {
                $('#hName').val(name);
            }
        }
    </script>
    }
